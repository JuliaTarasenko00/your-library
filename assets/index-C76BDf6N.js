import{r as l,h as j,j as t,i as g,f as N,u as B,c as h,e as E,b as L,F as C}from"./index-Gdo5W-Ll.js";import{G as y}from"./iconBase-sbVVsZG_.js";import{b as _}from"./index-CCC61CHv.js";import{u as z,a as M,t as T}from"./toastStyle-CnZ7v1oI.js";import{b as S,g as $,c as q}from"./Title-B6AE3tXi.js";function I(e){return y({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M5 20a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V8h2V6h-4V4a2 2 0 0 0-2-2H9a2 2 0 0 0-2 2v2H3v2h2zM9 4h6v2H9zM8 8h9v12H7V8z"},child:[]},{tag:"path",attr:{d:"M9 10h2v8H9zm4 0h2v8h-2z"},child:[]}]})(e)}const A=()=>{const[e,s]=l.useState(!1),r=()=>{s(!e)};return l.useEffect(()=>{e?document.body.style.overflow="hidden":document.body.style.overflow="auto"},[e]),{open:e,onToggleModal:r}},D=document.getElementById("modal"),H=({children:e,closeModal:s,isOpen:r})=>{const a=o=>{o.currentTarget===o.target&&s()};return l.useEffect(()=>{const o=x=>{x.code==="Escape"&&s()};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}},[s]),j.createPortal(t.jsxs("div",{className:`relative z-10 ${r?"h-100% w-100% opacity-100":"h-0 w-0 opacity-0"} transition duration-[450ms] ease-out`,"aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:[t.jsx("div",{className:`${r?"h-100% w-100% opacity-100":"h-0 w-0 opacity-0"} fixed inset-0 transition duration-[450ms] ease-out`,"aria-hidden":"true"}),t.jsx("div",{className:`fixed inset-0 ${r?"h-100% w-100% opacity-100":"h-0 w-0 opacity-0"} z-10 w-screen overflow-y-auto transition duration-[450ms] ease-out`,children:t.jsx("div",{className:`flex min-h-full items-center justify-center ${r?"h-100% w-100% opacity-100":"h-0 w-0 opacity-0"} sm:items-center sm:p-0 bg-[#14141499] p-4 text-center transition duration-[450ms] ease-out`,onClick:a,children:t.jsxs("div",{className:"relative rounded-[12px] border-[1px] border-[#68686833] bg-[#1F1F1F] px-[25px] py-[40px] md:min-w-[450px] md:p-[50px]",children:[t.jsx("button",{type:"button",className:"absolute right-[16px] top-[16px] h-[22px] w-[22px]",onClick:s,children:t.jsx(_,{})}),e]})})})]}),D)},K=()=>{const{mutate:e,isPending:s}=z({mutationKey:["add/book_to_library_by_id"],mutationFn:r=>S(r)});return{mutate:e,isPending:s}},R=()=>{const{data:e,isLoading:s}=g({queryKey:["fetch/get_library"],queryFn:$});return{data:e,isLoading:s}},b="/your-library/assets/image_not_found-BOi_YEjh.jpg",k=({book:e,closeModal:s,isOpen:r})=>{const a=N(),o=B(),{mutate:x,isPending:m}=K(),{data:i}=R(),u=(e==null?void 0:e.imageUrl)!==null?e==null?void 0:e.imageUrl:b,c=()=>{e!=null&&e._id&&x(e._id,{onSuccess:async()=>{await a.invalidateQueries({queryKey:["fetch/get_library"]}),h.success("Your book is now in the library!",{style:M})},onError:p=>{h.error(p.message,{style:T})}})},d=l.useMemo(()=>(i==null?void 0:i.find(({title:p})=>(e==null?void 0:e.title)===p))??!1,[i,e]),n=d||e;return t.jsx(t.Fragment,{children:t.jsx(H,{closeModal:s,isOpen:r,children:!!n&&t.jsxs("div",{className:"flex max-w-[450px] flex-col items-center justify-center",children:[t.jsx("img",{src:u,alt:n.title,loading:"lazy",width:153,height:233,className:"mb-[16px] h-[213px] w-[140px] rounded-[8px] md:h-[233px] md:w-[153px]"}),t.jsx("p",{className:"mb-[2px] text-[18px] font-bold leading-[18px] text-[#F9F9F9] md:text-[20px] md:leading-[20px]",children:n.title}),t.jsx("p",{className:"mb-[4px] text-[12px] font-normal leading-[14px] text-[#686868] md:text-[14px] md:leading-[18px]",children:n.author}),t.jsx("p",{className:"mb-[20px] text-[10px] leading-[12px] text-[#F9F9F9] md:mb-[32px]",children:n.totalPages}),d?t.jsx("button",{type:"button",onClick:()=>{o(`/reading/${n._id}`),s()},className:"transition-custom rounded-[30px] border border-[#F9F9F933] px-[24px] py-[12px] text-[14px] font-bold leading-[18px] text-[#F9F9F9] hover:border-[#F9F9F9] hover:bg-[#F9F9F9] hover:text-[#1F1F1F] focus:border-[#F9F9F9] focus:bg-[#F9F9F9] focus:text-[#1F1F1F] md:px-[28px] md:py-[14px] md:text-[16px]",children:"Start reading"}):t.jsx("button",{type:"button",onClick:c,disabled:m,className:"transition-custom rounded-[30px] border border-[#F9F9F933] px-[24px] py-[12px] text-[14px] font-bold leading-[18px] text-[#F9F9F9] hover:border-[#F9F9F9] hover:bg-[#F9F9F9] hover:text-[#1F1F1F] focus:border-[#F9F9F9] focus:bg-[#F9F9F9] focus:text-[#1F1F1F] md:px-[28px] md:py-[14px] md:text-[16px]",children:"Add to library"})]})})})},U=({data:e,onDeleteBookFromLibrary:s})=>{const{open:r,onToggleModal:a}=A(),[o,x]=l.useState(null),{pathname:m}=E(),i=m===L.library,u=c=>{const d=e==null?void 0:e.find(({_id:n})=>n===c);x(d),a()};return t.jsxs(t.Fragment,{children:[t.jsx("ul",{className:"grid grid-cols-2 justify-center gap-x-[8px] xs:gap-x-[21px] md:grid-cols-4 md:gap-x-[20px] md:gap-y-[27px] xl:grid-cols-5",children:e==null?void 0:e.map(({_id:c,imageUrl:d,title:n,author:p})=>{const F=i?11:22,f=`${n.slice(0,F)}${n.length>=F?"...":""}`,w=d!==null?d:b;return t.jsxs("li",{className:"mx-auto mt-0 flex w-[120px] cursor-pointer flex-col xs:w-[137px]",onClick:()=>u(c),children:[t.jsx("img",{src:w,alt:n,width:137,height:208,loading:"lazy",className:"h-[208px] rounded-[8px]"}),t.jsxs("div",{className:`${i?"flex items-center justify-between gap-[5px]":""} flex-grow-[1]`,children:[t.jsxs("div",{children:[t.jsx("h2",{className:"mb-[2px] mt-[8px] text-[14px] font-bold leading-[18px] text-[#F9F9F9]",children:f}),t.jsx("h4",{className:"text-[10px] font-normal leading-[12px] text-[#686868]",children:p})]}),i&&t.jsx("button",{type:"button",onClick:v=>{s&&s(v,c)},className:"flex h-[28px] w-[28px] min-w-[28px] items-center justify-center rounded-[14px] border-[1px] border-[#E8505033] bg-[#E850501A]",children:t.jsx(I,{className:"h-[14px] w-[14px] text-[#E85050]"})})]})]},c)})}),t.jsx(k,{book:o,closeModal:a,isOpen:r})]})},P=()=>{const e=l.useContext(C);if(!e)throw new Error("some problems with book filtering");return e},J=(e,s)=>{const{value:{title:r,author:a}}=P(),{data:o,isLoading:x}=g({queryKey:["response/recommend_book",e,s,r,a],queryFn:()=>q(e,s,r,a),enabled:!!e&&!!s});return{data:o,isLoading:x}},W="transition-custom disabled:cursor-no-drop rounded-[30px] border-[1px] border-[#F9F9F933] bg-transparent px-[20px] py-[10px] md:px-[28px] md:py-[12px] text-[14px] md:text-[16px] font-bold leading-[18px] text-[#F9F9F9] hover:border-[#F9F9F9] hover:bg-[#F9F9F9] hover:text-[#1F1F1F] focus:border-[#F9F9F9] focus:bg-[#F9F9F9] focus:text-[#1F1F1F] disabled:hover:border-[#F9F9F933] disabled:hover:bg-transparent disabled:hover:text-[#F9F9F9] disabled:focus:border-[#F9F9F933] disabled:focus:bg-transparent disabled:focus:text-[#F9F9F9]",X="md:h-[44px] rounded-[30px] flex items-center justify-center md:w-[44px] md:min-w-[44px] h-[40px] w-[40px] min-w-[40px] bg-[#F9F9F9] text-[#1F1F1F] text-[20px] font-bold text-center",Z="flex items-center gap-[12px]",ee="text-[14px] font-medium leading-[18px] text-[#686868] text-balance";function te(e){return y({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l370.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128z"},child:[]}]})(e)}export{U as B,te as F,J as a,R as b,X as n,W as s,ee as t,P as u,Z as w};
