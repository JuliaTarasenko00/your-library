import{r as c,f as w,j as e,$ as m,h as g,c as F,e as j,b as v,F as N}from"./index-BaMuIyxS.js";import{G as b}from"./iconBase-CoJq047M.js";import{c as k,u as B,d as $,t as E}from"./toastStyle-DyCgTjvs.js";function L(t){return b({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M5 20a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V8h2V6h-4V4a2 2 0 0 0-2-2H9a2 2 0 0 0-2 2v2H3v2h2zM9 4h6v2H9zM8 8h9v12H7V8z"},child:[]},{tag:"path",attr:{d:"M9 10h2v8H9zm4 0h2v8h-2z"},child:[]}]})(t)}const T=()=>{const[t,s]=c.useState(!1),o=()=>{s(!t)};return c.useEffect(()=>{t?document.body.style.overflow="hidden":document.body.style.overflow="auto"},[t]),{open:t,onToggleModal:o}},C=document.getElementById("modal"),M=({children:t,closeModal:s,isOpen:o})=>{const n=r=>{r.currentTarget===r.target&&s()};return c.useEffect(()=>{const r=a=>{a.code==="Escape"&&s()};return window.addEventListener("keydown",r),()=>{window.removeEventListener("keydown",r)}},[s]),w.createPortal(e.jsxs("div",{className:`relative z-10 ${o?"h-100% w-100% opacity-100":"h-0 w-0 opacity-0"} transition duration-[450ms] ease-out`,"aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:[e.jsx("div",{className:`${o?"h-100% w-100% opacity-100":"h-0 w-0 opacity-0"} fixed inset-0 transition duration-[450ms] ease-out`,"aria-hidden":"true"}),e.jsx("div",{className:`fixed inset-0 ${o?"h-100% w-100% opacity-100":"h-0 w-0 opacity-0"} z-10 w-screen overflow-y-auto transition duration-[450ms] ease-out`,children:e.jsx("div",{className:`flex min-h-full items-center justify-center ${o?"h-100% w-100% opacity-100":"h-0 w-0 opacity-0"} sm:items-center sm:p-0 bg-[#14141499] p-4 text-center transition duration-[450ms] ease-out`,onClick:n,children:e.jsxs("div",{className:"relative rounded-[12px] border-[1px] border-[#68686833] bg-[#1F1F1F] px-[25px] py-[40px] md:p-[50px]",children:[e.jsx("button",{type:"button",className:"absolute right-[16px] top-[16px] h-[22px] w-[22px]",onClick:s,children:e.jsx(k,{})}),t]})})})]}),C)},u="/books",z=async(t=1,s=10,o="",n="")=>{const{data:r}=await m.get(`${u}/recommend?page=${t}&limit=${s}&title=${o}&author=${n}`);return r},S=async t=>{const{data:s}=await m.post(`${u}/add/${t}`);return s},_=async()=>{const{data:t}=await m.get(`${u}/own`);return t},A=()=>{const{mutate:t}=B({mutationKey:["add/book_to_library_by_id"],mutationFn:s=>S(s)});return{mutate:t}},D=()=>{const{data:t,isLoading:s}=g({queryKey:["fetch/get_library"],queryFn:_});return{data:t,isLoading:s}},I=({book:t,closeModal:s,isOpen:o})=>{const{mutate:n}=A(),{data:r}=D(),a=r!==null&&t!==null&&(r==null?void 0:r.some(({title:d})=>t.title===d));console.log(a);const x=d=>{n(d,{onSuccess:()=>{F.success("Your book is now in the library! The joy knows no bounds and now you can start your training",{style:$})},onError:i=>{F.error(i.message,{style:E})}})};return e.jsx(M,{closeModal:s,isOpen:o,children:t!==null&&e.jsxs("div",{className:"flex max-w-[450px] flex-col items-center justify-center",children:[e.jsx("img",{src:t.imageUrl,alt:t.title,width:153,height:233,className:"mb-[16px] h-[213px] w-[140px] rounded-[8px] md:h-[233px] md:w-[153px]"}),e.jsx("p",{className:"mb-[2px] text-[18px] font-bold leading-[18px] text-[#F9F9F9] md:text-[20px] md:leading-[20px]",children:t.title}),e.jsx("p",{className:"mb-[4px] text-[12px] font-normal leading-[14px] text-[#686868] md:text-[14px] md:leading-[18px]",children:t.author}),e.jsx("p",{className:"mb-[20px] text-[10px] leading-[12px] text-[#F9F9F9] md:mb-[32px]",children:t.totalPages}),a?e.jsx("p",{children:"Start reading"}):e.jsx("button",{type:"button",onClick:()=>x(t._id),className:"transition-custom rounded-[30px] border-[1px] border-[#F9F9F933] px-[24px] py-[12px] text-[14px] font-bold leading-[18px] text-[#F9F9F9] hover:border-[#F9F9F9] hover:bg-[#F9F9F9] hover:text-[#1F1F1F] focus:border-[#F9F9F9] focus:bg-[#F9F9F9] focus:text-[#1F1F1F] md:px-[28px] md:py-[14px] md:text-[16px]",children:"Add to library"})]})})},G=({data:t})=>{const{open:s,onToggleModal:o}=T(),[n,r]=c.useState(null),{pathname:a}=j(),x=a===v.library,d=i=>{const p=t==null?void 0:t.find(({_id:l})=>l===i);r(p),o()};return e.jsxs(e.Fragment,{children:[e.jsx("ul",{className:"grid grid-cols-2 justify-center gap-x-[8px] xs:gap-x-[21px] md:grid-cols-4 md:gap-x-[20px] md:gap-y-[27px] xl:grid-cols-5",children:t==null?void 0:t.map(({_id:i,imageUrl:p,title:l,author:y})=>{const h=x?11:22,f=`${l.slice(0,h)}${l.length>=h?"...":""}`;return e.jsxs("li",{className:"mx-auto mt-0 flex w-[120px] cursor-pointer flex-col xs:w-[137px]",onClick:()=>d(i),children:[e.jsx("img",{src:p,alt:l,width:137,height:208,loading:"lazy",className:"h-[208px] rounded-[8px]"}),e.jsxs("div",{className:`${x?"flex items-center justify-between gap-[5px]":""} flex-grow-[1]`,children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mb-[2px] mt-[8px] text-[14px] font-bold leading-[18px] text-[#F9F9F9]",children:f}),e.jsx("h4",{className:"text-[10px] font-normal leading-[12px] text-[#686868]",children:y})]}),x&&e.jsx("button",{type:"button",className:"flex h-[28px] w-[28px] min-w-[28px] items-center justify-center rounded-[14px] border-[1px] border-[#E8505033] bg-[#E850501A]",children:e.jsx(L,{className:"h-[14px] w-[14px] text-[#E85050]"})})]})]},i)})}),e.jsx(I,{book:n,closeModal:o,isOpen:s})]})},H=()=>{const t=c.useContext(N);if(!t)throw new Error("some problems with book filtering");return t},P=(t,s)=>{const{value:{title:o,author:n}}=H(),{data:r,isLoading:a}=g({queryKey:["response/recommend_book",t,s,o,n],queryFn:()=>z(t,s,o,n),enabled:!!t&&!!s});return{data:r,isLoading:a}},R=({children:t})=>e.jsx("aside",{className:"grid gap-[20px] rounded-[30px] bg-[#1F1F1F] px-[20px] py-[20px] md:grid-cols-2 md:gap-[32px] md:py-[32px] lg:grid-cols-1 lg:gap-[20px] lg:py-[40px]",children:t}),Q=({children:t,childrenSecond:s})=>e.jsxs("div",{className:"container-custom grid gap-[16px] pb-[27px] lg:grid-cols-[1fr_2.6fr]",children:[e.jsx(R,{children:s}),e.jsx("section",{className:"min-h-[398px] rounded-[30px] bg-[#1F1F1F] px-[20px] py-[40px] md:min-h-[681px] md:p-[40px] lg:min-h-full",children:t})]}),U="transition-custom disabled:cursor-no-drop rounded-[30px] border-[1px] border-[#F9F9F933] bg-transparent px-[20px] py-[10px] md:px-[28px] md:py-[12px] text-[14px] md:text-[16px] font-bold leading-[18px] text-[#F9F9F9] hover:border-[#F9F9F9] hover:bg-[#F9F9F9] hover:text-[#1F1F1F] focus:border-[#F9F9F9] focus:bg-[#F9F9F9] focus:text-[#1F1F1F] disabled:hover:border-[#F9F9F933] disabled:hover:bg-transparent disabled:hover:text-[#F9F9F9] disabled:focus:border-[#F9F9F933] disabled:focus:bg-transparent disabled:focus:text-[#F9F9F9]",Y="md:h-[44px] rounded-[30px] flex items-center justify-center md:w-[44px] md:min-w-[44px] h-[40px] w-[40px] min-w-[40px] bg-[#F9F9F9] text-[#1F1F1F] text-[20px] font-bold text-center",J="flex items-center gap-[12px]",O="text-[14px] font-medium leading-[18px] text-[#686868]";function W(t){return b({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l370.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128z"},child:[]}]})(t)}const X=({children:t})=>e.jsx("h2",{className:"text-[20px] font-bold leading-[32px] text-[#F9F9F9] md:text-[28px]",children:t});export{G as B,Q as C,W as F,X as T,P as a,D as b,Y as n,U as s,O as t,H as u,J as w};
